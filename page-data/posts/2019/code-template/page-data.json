{"componentChunkName":"component---node-modules-pauliescanlon-gatsby-theme-terminal-src-layouts-source-layout-js","path":"/posts/2019/code-template/","result":{"data":{"mdx":{"id":"5b2e12c1-416a-5652-82a2-c7905003f266","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"代码模版\",\n  \"author\": \"Von\",\n  \"tags\": [\"Template\", \"Code\"],\n  \"featuredImage\": \"bbg.jpg\",\n  \"date\": \"2019-11-06T00:00:00.000Z\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Code Template\"), mdx(\"h2\", null, \"Python\\u591A\\u8FDB\\u7A0B\\u5199\\u5165\\u6587\\u4EF6(multiprocessing template)\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.python.org/2/library/multiprocessing.html?highlight=apply_async#multiprocessing.pool.multiprocessing.Pool.apply_async\"\n  }), \"\\u53C2\\u8003\\u6587\\u6863\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"#multiprocessing template\\nimport multiprocessing\\n\\ndef write_file(result):\\n    f = open('')\\n    f.write(result)\\n\\ndef process(args):\\n    '''\\n    work\\n    '''\\n    return result\\n\\nif __name__ == '__main__':\\n    pool = multiprocessing.Pool(processes = 100)\\n    for t in tasks:\\n        pool.apply_async(process, (t, ),callback=write_file)\\n    pool.close()\\n    pool.join()\\n\")), mdx(\"h2\", null, \"\\u9AD8\\u6B21\\u65B9\\u53D6\\u6A21\"), mdx(\"h3\", null, \"\\u6B21\\u65B9\\u6C42\\u6A21\\u6A21\\u677F\"), mdx(\"p\", null, \"\\u5C31\\u662F\\u6C42\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"(a^b)% p\"), \"\\u5176\\u4E2D a, b, p \\u6570\\u503C\\u6BD4\\u8F83\\u5927\\n\\u53D6\\u4F59\\u516C\\u5F0F\\uFF1A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"(a\", mdx(\"em\", {\n    parentName: \"strong\"\n  }, \"b)% p = (a%p \"), \" b%p)% p\"), \"\\n\", mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"mod.jpeg\",\n    \"alt\": null\n  }))), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-cpp\"\n  }), \"//\\u6B21\\u65B9\\u6C42\\u6A21\\u6A21\\u677F\\ntemplate<class Type>\\ninline Type ModPow(Type m,Type n,Type p) //m\\u7684n\\u6B21\\u65B9\\u6A21p\\n{\\n    if(n==0) return 1;\\n    if (n==1) return m%p;\\n        Type tmp=ModPow(m,n>>1,p);\\n    return (tmp*tmp%p)*((n%2?m:1)%p)%p;\\n}\\n\")), mdx(\"h3\", null, \"\\u9AD8\\u6B21\\u65B9\\u6C42\\u6A21\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-cpp\"\n  }), \"/*\\u9AD8\\u6B21\\u65B9\\u6C42\\u6A21\\uFF1A\\n\\u6BD4\\u5982a\\u7684b\\u6B21\\u65B9\\u5BF9c\\u6C42\\u6A21\\n\\u6211\\u4EEC\\u53EF\\u4EE5\\u628Ab \\u5316\\u4E3A\\u4E8C\\u8FDB\\u5236\\u5F62\\u5F0F\\u770B\\u90A3\\u4E00\\u4F4D\\u67091\\n\\u6BD4\\u5982b=10101\\u5219  a^b=a^(10000)*a^(100)*a^(1)\\n\\u4EE5\\u51FD\\u6570\\u5F62\\u5F0F\\u4F53\\u73B0\\uFF1A*/\\ntemplate<class Type>\\ninline Type han()\\n{\\n    Type t,s;\\n    for(t=a,s=1;b;b>>=1,t*=t,t%=c)//\\u7528b>>=1\\u67E5\\u770Bb\\u4E2D1\\n     if(b&1){s*=t;s%=c;}\\n    return s%c;\\n}\\n\")), mdx(\"h3\", null, \"\\u5927\\u6570\\u53D6\\u6A21\\u7684\\u6A21\\u677F\"), mdx(\"p\", null, \"\\u53D6\\u4F59\\u516C\\u5F0F\\uFF1A(a+b)% p = (a%p+b%p)% p;\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-cpp\"\n  }), \"char big_number[MAX];\\ntemplate<class type>\\ntype big_mod(char *a,type mod){\\n    type len=strlen(a),result=0;\\n    for(int i=0;i<len;i++){\\n        result=((result*10)%mod+(a[i]-'0')%mod)%mod;\\n        //\\u5982\\u679C\\u6570\\u636E\\u4E0D\\u7B97\\u592A\\u5927\\uFF0C\\u53EF\\u4EE5\\u5199\\u6210\\u8FD9\\u6837\\u6765\\u8282\\u7701\\u65F6\\u95F4result=(result*10+a[i]-'0')%mod;\\n    }\\n    return result;\\n}\\n//test\\nchar s[200];\\nint main()\\n{   while(gets(s))\\n        cout<<big_mod<int>(s,2)<<endl;\\n}\\n\")), mdx(\"h2\", null, \"\\u54C8\\u5E0C\\u6A21\\u7248(hash template)\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"const int  MAX=1000003;\\ntemplate <class T>\\nclass hash\\n{\\nprivate:\\n    int pos;\\n    int next[MAX];\\n    int head[MAX];\\n    T key[MAX];\\npublic:\\n    hash();\\n    bool search(T x);\\n    void push(T x);\\n};\\ntemplate <class T>\\nhash<T>::hash()\\n{\\n    pos=0;\\n    memset(next,-1,sizeof(next));\\n    memset(head,-1,sizeof(head));\\n    //memset(key,-1,sizeof(key));\\n}\\ntemplate <class T>\\ninline bool hash<T>::search(const T x)\\n{\\n    int temp=x%MAX;\\n    int t=head[temp];\\n    while(t!=-1)\\n    {\\n        if (key[t]==x)\\n        {\\n            return 1;\\n        }\\n        t=next[t];\\n    }\\n    return 0;\\n}\\ntemplate <class T>\\ninline void hash<T>::push(const T x)\\n{\\n    int temp=x% MAX;\\n    if (head[temp]!=-1)\\n    {\\n        next[pos]=head[temp];\\n    }\\n    head[temp]=pos;\\n    key[pos]=x;\\n    pos++;\\n}\\n\")), mdx(\"h2\", null, \"Python \\u534F\\u7A0B\\u5904\\u7406 requests\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"from gevent import monkey\\nmonkey.patch_all()\\n\\nimport sys\\nreload(sys)\\nsys.setdefaultencoding('utf-8')\\n\\nimport requests\\nimport time\\nimport gevent\\nfrom gevent import pool\\nimport re\\nimport math\\nimport pymysql\\nimport functools\\nfrom DBUtils.PooledDB import PooledDB\\nfrom datetime import datetime\\nfrom collections import defaultdict\\n\\n# db ip\\n'''\\ndb msg\\n'''\\n# \\u6570\\u636E\\u5E93\\u8FDE\\u63A5\\u6C60\\nmysql_db_pool = PooledDB(creator=pymysql, mincached=1, maxcached=2, maxconnections=100, host=base_ip, port=3306,\\n                         user=base_user, passwd=base_pwd, db=base_db, charset='utf8', use_unicode=False, blocking=True)\\n# target url\\nURL = ''\\n\\n\\ncomplete_count = 0\\n# log--\\nfunc_count_dict = defaultdict(int)\\n\\ndef func_time_logger(fun):\\n    if fun.__dict__.get('mioji.aop_utils.logger', False):\\n        return fun\\n    fun.__dict__['mioji.aop_utils.logger'] = True\\n\\n    @functools.wraps(fun)\\n    def logging(*args, **kw):\\n        func_count_dict[fun.__name__] += 1\\n        begin = datetime.now()\\n        result = fun(*args, **kw)\\n        end = datetime.now()\\n        func_count_dict[fun.__name__] -= 1\\n        print 'func {0}, cost:{1}, ex:{2}'.format(fun.__name__, end - begin , func_count_dict[fun.__name__])\\n        return result\\n\\n    return logging\\n# --log\\n\\n# \\u83B7\\u5F97\\u4EE3\\u7406\\n@func_time_logger\\ndef get_PROXY():\\n    # \\u4EE3\\u7406url\\n    R = requests.get(url)\\n    p = R.content\\n    if p.startswith('10.'):\\n        # if p.split(':')[0] in SOCKS_PROXY:\\n        PROXY = {\\n        'http': 'socks5://' + p,\\n        'https': 'socks5://' + p\\n        }\\n    else:\\n        self.real_ip = p.split(':')[0]\\n        proxy_type = 'http'\\n        PROXY = {\\n            'https': 'http://' + p,\\n            'http': 'http://' + p,\\n        }\\n\\n    return PROXY\\n\\n# requests\\n@func_time_logger\\ndef get_request_data(x, y):\\n    i = 0\\n    while i < 3:\\n        try:\\n            r = requests.get(URL, proxies=get_PROXY(), timeout=(5, 10))\\n            data = r.content\\n            return data\\n        except:\\n            print 'get error'\\n            i += 1\\n    return None\\n\\n# process function\\n@func_time_logger\\ndef process(a1,a2):\\n\\n    get_request_data(x,y)\\n\\n    '''\\n    other works\\n    '''\\n\\n    global complete_count\\n    complete_count += 1\\n    print 'end {0}'.format(sid)\\n    print 'complete {0}'.format(complete_count)\\n\\n# \\u5F02\\u6B65\\u534F\\u7A0B\\u5904\\u7406\\u8BF7\\u6C42\\u91CF\\u5927\\u7684\\u9700\\u6C42\\nif __name__ == '__main__':\\n    s = time.time()\\n\\n    gs = []\\n    for data in data_list:\\n        g = execute_pool.apply_async(process, args=(a1, a2,))\\n        gs.append(g)\\n    gevent.joinall(gs)\\n\\n    print time.time() - s\\n\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Code Template Python多进程写入文件(multiprocessing template) 参考文档 高次方取模 次方求模模板 就是求 (a^b)% p 其中 a, b, p 数值比较大\n取余公式： (a b)% p = (a%p   b%p)% p…","timeToRead":1,"wordCount":{"words":39},"frontmatter":{"title":"代码模版","tags":["Template","Code"],"date":"2019-11-06T00:00:00.000Z","dateModified":null,"author":"Von","status":null,"isPrivate":null,"featuredImage":{"childImageSharp":{"original":{"width":5760,"height":3840,"src":"/static/bbg-1b8d110f9a554fa502b066dbf55c191e.jpg"},"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABx2pdEiuH/8QAGBABAQEBAQAAAAAAAAAAAAAAAQAREBL/2gAIAQEAAQUCOe0i3Jb/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERMVFhweH/2gAIAQEAAT8h5Fq8EvOjMWgg8H//2gAMAwEAAgADAAAAEGPf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QI//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAgEBPxBcLG//xAAaEAEBAQADAQAAAAAAAAAAAAABEQAhMWFx/9oACAEBAAE/EDIwF1KET60hRD1rTz3uEA6wwl3/2Q==","aspectRatio":1.5,"src":"/static/1b8d110f9a554fa502b066dbf55c191e/a6c62/bbg.jpg","srcSet":"/static/1b8d110f9a554fa502b066dbf55c191e/b3cab/bbg.jpg 300w,\n/static/1b8d110f9a554fa502b066dbf55c191e/39f27/bbg.jpg 600w,\n/static/1b8d110f9a554fa502b066dbf55c191e/a6c62/bbg.jpg 1200w,\n/static/1b8d110f9a554fa502b066dbf55c191e/8d3de/bbg.jpg 1800w,\n/static/1b8d110f9a554fa502b066dbf55c191e/f0a07/bbg.jpg 2400w,\n/static/1b8d110f9a554fa502b066dbf55c191e/f477f/bbg.jpg 5760w","sizes":"(max-width: 1200px) 100vw, 1200px"},"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABx2pdEiuH/8QAGBABAQEBAQAAAAAAAAAAAAAAAQAREBL/2gAIAQEAAQUCOe0i3Jb/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERMVFhweH/2gAIAQEAAT8h5Fq8EvOjMWgg8H//2gAMAwEAAgADAAAAEGPf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QI//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAgEBPxBcLG//xAAaEAEBAQADAQAAAAAAAAAAAAABEQAhMWFx/9oACAEBAAE/EDIwF1KET60hRD1rTz3uEA6wwl3/2Q==","width":400,"height":267,"src":"/static/1b8d110f9a554fa502b066dbf55c191e/64b17/bbg.jpg","srcSet":"/static/1b8d110f9a554fa502b066dbf55c191e/64b17/bbg.jpg 1x,\n/static/1b8d110f9a554fa502b066dbf55c191e/39f27/bbg.jpg 1.5x,\n/static/1b8d110f9a554fa502b066dbf55c191e/a1eb1/bbg.jpg 2x"},"id":"84c033a4-fdd3-5fab-bda9-ad24fc86bc79"}},"embeddedImages":null},"fields":{"slug":"/posts/2019/code-template/","owner":"source","parent":"posts"}}},"pageContext":{"id":"5b2e12c1-416a-5652-82a2-c7905003f266","prev":{"frontmatter":{"title":"每天学点数学","status":null},"fields":{"slug":"/posts/2019/math-every/"}},"next":{"frontmatter":{"title":"Python编码问题","status":null},"fields":{"slug":"/posts/2019/python-encoding/"}},"parent":"posts"}}}