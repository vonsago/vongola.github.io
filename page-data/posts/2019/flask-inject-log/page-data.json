{"componentChunkName":"component---node-modules-pauliescanlon-gatsby-theme-terminal-src-layouts-source-layout-js","path":"/posts/2019/flask-inject-log/","result":{"data":{"mdx":{"id":"d3ab5719-ff9d-5348-81f1-0195b0981497","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Flask 注入自定义的日志\",\n  \"date\": \"2019-11-26T00:00:00.000Z\",\n  \"author\": \"Von\",\n  \"tags\": [\"Flask\", \"Web\", \"Python\"],\n  \"featuredImage\": \"bg.jpeg\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Flask logging\"), mdx(\"p\", null, \"\\u4F7F\\u7528 Flask \\u65F6\\uFF0C\\u5982\\u4F55\\u4F18\\u96C5\\u7684\\u8F93\\u51FA\\u65E5\\u5FD7\\u3002\\u8FD9\\u4E9B\\u65E5\\u5FD7\\u4E5F\\u8BB8\\u9700\\u8981\\u7279\\u5B9A\\u7684\\u683C\\u5F0F\\uFF0C\\u66F4\\u4E30\\u5BCC\\u7684\\u4FE1\\u606F\\uFF0C\\u6216\\u8005\\u6DFB\\u52A0\\u4E00\\u4E9B\\u4E0A\\u4E0B\\u6587\\u7684\\u4FE1\\u606F\\uFF08\\u5982\\u5F53\\u524D\\u767B\\u5F55\\u7684\\u7528\\u6237\\u540D\\uFF09\\u7B49\\u7B49\\u3002\"), mdx(\"p\", null, \"\\u6839\\u636E\\u5B98\\u65B9\\u6587\\u6863\\u6765\\u770B\\uFF0C\\u5F53\\u60F3\\u8981\\u4E3A\\u9879\\u76EE\\u914D\\u7F6E\\u65E5\\u5FD7\\u65F6\\uFF0C\\u5E94\\u5F53\\u5728\\u7A0B\\u5E8F\\u542F\\u52A8\\u65F6\\u5C3D\\u65E9\\u8FDB\\u884C\\u914D\\u7F6E\\u3002\\u6BD4\\u5982\\u5728\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"flask_app = Flask('api-controller')\"), \"\\u4E4B\\u524D\\u914D\\u7F6E\\u3002\\n\\u5982\\u679C\\u4E0D\\u914D\\u7F6E\\uFF0Cflask \\u4F1A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"create_logger\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-none\"\n  }), \"# flask source code \\u4E2D\\u662F\\u8FD9\\u6837\\u7684\\ndefault_handler = logging.StreamHandler(wsgi_errors_stream)\\ndefault_handler.setFormatter(\\n    logging.Formatter(\\\"[%(asctime)s] %(levelname)s in %(module)s: %(message)s\\\")\\n)\\n# \\u6240\\u4EE5\\u4F7F\\u7528\\u7F3A\\u7701\\u914D\\u7F6E\\u65F6\\n\\n\")), mdx(\"p\", null, \"\\u5982\\u679C\\u5728\\u64CD\\u4F5C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"app.logger\"), \" \\u4E4B\\u540E\\u914D\\u7F6E\\u65E5\\u5FD7\\uFF0C\\u5E76\\u4E14\\u9700\\u8981 \\u79FB\\u9664\\u7F3A\\u7701\\u7684\\u65E5\\u5FD7\\u8BB0\\u5F55\\u5668\\uFF0C\\u53EF\\u4EE5\\u5BFC\\u5165\\u5E76\\u79FB\\u9664\\u5B83:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"from flask.logging import default_handler\\n\\nflask_app.logger.removeHandler(default_handler)\\n\")), mdx(\"p\", null, \"\\u5B9E\\u9645\\u4E0A\\uFF0C\\u5728\\u8BBE\\u7F6E\\u5B8C basicConfig \\u540E\\u4E5F\\u53EF\\u4EE5\\u901A\\u8FC7\\u4E0B\\u9762\\u65B9\\u5F0F\\u4FEE\\u6539\\u3002\\u8FD9\\u6BB5\\u4EE3\\u7801\\u7684\\u5F71\\u54CD\\u662F**\\u5728\\u6240\\u6709\\u65E5\\u5FD7\\u540E\\u9762\\u589E\\u52A0\\u4E00\\u4E2A\\u4E0A\\u4E0B\\u6587\\u53C2\\u6570\\uFF08\\u5F53\\u524D\\u767B\\u5F55\\u7684\\u7528\\u6237\\u540D\\uFF09\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"from flask import g\\nusername = g.user.name\\nroot = logging.getLogger()\\nhandler = logging.StreamHandler()\\nformatter = logging.Formatter('%(asctime)s %(name)s %(levelname)-8s %(message)s' + f\\\" User: {username}\\\")\\nhandler.setFormatter(formatter)\\nroot.handlers = [handler]\\n\")), mdx(\"p\", null, \"\\u5E94\\u7528\\u7A0B\\u5E8F\\u4EE3\\u7801\\u53EF\\u4EE5\\u5728\\u4E00\\u4E2A\\u6A21\\u5757\\u4E2D\\u5B9A\\u4E49\\u548C\\u914D\\u7F6E\\u7236\\u8BB0\\u5F55\\u5668\\uFF0C\\u5E76\\u5728\\u5355\\u72EC\\u7684\\u6A21\\u5757\\u4E2D\\u521B\\u5EFA\\uFF08\\u4F46\\u4E0D\\u914D\\u7F6E\\uFF09\\u5B50\\u8BB0\\u5F55\\u5668\\uFF0C\\u5E76\\u4E14\\u5BF9\\u5B50\\u8BB0\\u5F55\\u5668\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6240\\u6709\\u8C03\\u7528\\u90FD\\u5C06\\u4F20\\u9012\\u7ED9\\u7236\\u8BB0\\u5F55\\u5668\"), \"\\u3002\"), mdx(\"p\", null, \"\\u6BD4\\u5982\\u4E0A\\u9762\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"logging.getLogger() # \\u540C logging.getLogger('')\"), \" \\u5176\\u5B9E\\u5C31\\u662F\\u83B7\\u53D6\\u4E86 root logger \\u5E76\\u4F5C\\u4FEE\\u6539\\u3002\\n\\u4E0A\\u8FF0\\u4EE3\\u7801\\u5199\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@app.before_request\"), \" \\u51FD\\u6570\\u4E2D\\uFF0C\\u4F1A\\u5BF9\\u6240\\u6709\\u7684\\u65E5\\u5FD7\\u8F93\\u51FA\\u6709\\u5F71\\u54CD\\uFF1B\\n\\u5982\\u679C\\u5199\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@app.after_request\"), \" \\u51FD\\u6570\\u4E2D\\uFF0C\\u53EA\\u4F1A\\u5F71\\u54CD \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"werkzeug\"), \" \\u7684\\u65E5\\u5FD7\\u8F93\\u51FA\\u3002\\n\\u6BD4\\u5982\\u5728\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"flask\"), \"\\u5E94\\u7528\\u4E2D\\u6211\\u4EEC\\u7684\\u76EE\\u5F55\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"app\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"# create logger with app and config it\\nlogging.getLogger(\\\"app\\\").setLevel(log_level)\\n\")), mdx(\"p\", null, \"\\u90A3\\u4E48\\u6240\\u6709\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"app.*\"), \" \\u6587\\u4EF6\\u4E0B\\u7684 logger \\u90FD\\u4F1A\\u8FD9\\u4E2A\\u7236\\u8BB0\\u5F55\\u5668\\u7684\\u5F71\\u54CD\\u3002\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Flask logging 使用 Flask 时，如何优雅的输出日志。这些日志也许需要特定的格式，更丰富的信息，或者添加一些上下文的信息（如当前登录的用户名）等等。 根据官方文档来看，当想要为项目配置日志时，应当在程序启动时尽早进行配置。比如在 flask_app = Flask…","timeToRead":1,"wordCount":{"words":54},"frontmatter":{"title":"Flask 注入自定义的日志","tags":["Flask","Web","Python"],"date":"2019-11-26T00:00:00.000Z","dateModified":null,"author":"Von","status":null,"isPrivate":null,"featuredImage":{"childImageSharp":{"original":{"width":4896,"height":3264,"src":"/static/bg-23294f8a6d22cc25afe666275a09bacc.jpeg"},"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAFdOWFzjRn/xAAZEAADAQEBAAAAAAAAAAAAAAABAgMhEQD/2gAIAQEAAQUCnPpCK3mkOyfZtpO//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAEEAwAAAAAAAAAAAAAAAAABEBEhAzFy/9oACAEBAAY/ArFhNU0GTtv/xAAZEAADAQEBAAAAAAAAAAAAAAAAARFBITH/2gAIAQEAAT8h1Ugm1KPSHrhg5a9ouP/aAAwDAQACAAMAAAAQHN//xAAWEQADAAAAAAAAAAAAAAAAAAAQITH/2gAIAQMBAT8QSD//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxCq/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFBYdH/2gAIAQEAAT8QA17WD2XzK4OMkBUU1yBAKpmWBoG+FHyMim5//9k=","aspectRatio":1.5,"src":"/static/23294f8a6d22cc25afe666275a09bacc/a6c62/bg.jpg","srcSet":"/static/23294f8a6d22cc25afe666275a09bacc/b3cab/bg.jpg 300w,\n/static/23294f8a6d22cc25afe666275a09bacc/39f27/bg.jpg 600w,\n/static/23294f8a6d22cc25afe666275a09bacc/a6c62/bg.jpg 1200w,\n/static/23294f8a6d22cc25afe666275a09bacc/8d3de/bg.jpg 1800w,\n/static/23294f8a6d22cc25afe666275a09bacc/f0a07/bg.jpg 2400w,\n/static/23294f8a6d22cc25afe666275a09bacc/e41f5/bg.jpg 4896w","sizes":"(max-width: 1200px) 100vw, 1200px"},"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAFdOWFzjRn/xAAZEAADAQEBAAAAAAAAAAAAAAABAgMhEQD/2gAIAQEAAQUCnPpCK3mkOyfZtpO//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAEEAwAAAAAAAAAAAAAAAAABEBEhAzFy/9oACAEBAAY/ArFhNU0GTtv/xAAZEAADAQEBAAAAAAAAAAAAAAAAARFBITH/2gAIAQEAAT8h1Ugm1KPSHrhg5a9ouP/aAAwDAQACAAMAAAAQHN//xAAWEQADAAAAAAAAAAAAAAAAAAAQITH/2gAIAQMBAT8QSD//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxCq/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFBYdH/2gAIAQEAAT8QA17WD2XzK4OMkBUU1yBAKpmWBoG+FHyMim5//9k=","width":400,"height":267,"src":"/static/23294f8a6d22cc25afe666275a09bacc/64b17/bg.jpg","srcSet":"/static/23294f8a6d22cc25afe666275a09bacc/64b17/bg.jpg 1x,\n/static/23294f8a6d22cc25afe666275a09bacc/39f27/bg.jpg 1.5x,\n/static/23294f8a6d22cc25afe666275a09bacc/a1eb1/bg.jpg 2x"},"id":"2f812534-e562-5714-8112-0955b8df083f"}},"embeddedImages":null},"fields":{"slug":"/posts/2019/flask-inject-log/","owner":"source","parent":"posts"}}},"pageContext":{"id":"d3ab5719-ff9d-5348-81f1-0195b0981497","prev":{"frontmatter":{"title":"压缩图片","status":null},"fields":{"slug":"/posts/2019/zip-picture/"}},"next":{"frontmatter":{"title":"位运算的数学等价","status":null},"fields":{"slug":"/posts/2020/02/bit-calc/"}},"parent":"posts"}}}